# ZED AI Detection System

ì‹¤ì‹œê°„ AI ì´ë²¤íŠ¸ ê°ì§€ ì‹œìŠ¤í…œ - ZED ìŠ¤í…Œë ˆì˜¤ ì¹´ë©”ë¼, YOLOv8, WebSocket ìŠ¤íŠ¸ë¦¬ë° í™œìš©

## ì£¼ìš” ê¸°ëŠ¥

- **ì‹¤ì‹œê°„ ì‚¬ëŒ ê°ì§€**: YOLOv8 ê¸°ë°˜ ê³ ì„±ëŠ¥ ê°ì²´ ê°ì§€
- **ì›€ì§ì„ ì¶”ì **: 3D ìœ„ì¹˜ ì¶”ì  ë° ì´ë™ ê²½ë¡œ ë¶„ì„
- **ì´ë²¤íŠ¸ ê°ì§€**: êµ¬ì—­ ì§„ì…, ì†ë„ ê²½ê³ , ê±°ë¦¬ ë³€í™” ë“± ìë™ ì´ë²¤íŠ¸ ìƒì„±
- **ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë°**: WebSocket ê¸°ë°˜ ì‹¤ì‹œê°„ ì´ë²¤íŠ¸ ë¸Œë¡œë“œìºìŠ¤íŒ…
- **ì›¹ ì¸í„°í˜ì´ìŠ¤**: ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ ë° ì´ë²¤íŠ¸ í”¼ë“œ

## ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ZED 2i Camera  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ ZeroMQ (tcp://localhost:5555)
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     ZMQ Frame Receiver              â”‚
â”‚  - RGB Frame                        â”‚
â”‚  - Depth Frame                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   AI Detection Loop (Async)         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 1. Person Detection (YOLOv8)   â”‚ â”‚
â”‚  â”‚ 2. Movement Tracking           â”‚ â”‚
â”‚  â”‚ 3. Event Detection             â”‚ â”‚
â”‚  â”‚ 4. Event Broadcasting          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   FastAPI Backend (Port 8005)       â”‚
â”‚  - REST API Endpoints               â”‚
â”‚  - WebSocket Server                 â”‚
â”‚  - Event Queue Management           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Frontend (Port 5173)              â”‚
â”‚  - Real-time Event Feed             â”‚
â”‚  - Video Streaming                  â”‚
â”‚  - System Monitoring                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ê¸°ìˆ  ìŠ¤íƒ

### Backend
- **FastAPI**: ë¹„ë™ê¸° ì›¹ í”„ë ˆì„ì›Œí¬
- **YOLOv8**: ì‹¤ì‹œê°„ ê°ì²´ ê°ì§€
- **ZeroMQ**: ê³ ì„±ëŠ¥ í”„ë ˆì„ ìŠ¤íŠ¸ë¦¬ë°
- **WebSocket**: ì‹¤ì‹œê°„ ì–‘ë°©í–¥ í†µì‹ 
- **SQLite**: ì´ë²¤íŠ¸ ë°ì´í„°ë² ì´ìŠ¤

### Frontend
- **Vite**: ë¹Œë“œ ë„êµ¬
- **Vanilla JavaScript**: ê²½ëŸ‰ í”„ë¡ íŠ¸ì—”ë“œ
- **WebSocket Client**: ì‹¤ì‹œê°„ ë°ì´í„° ìˆ˜ì‹ 

### AI & Computer Vision
- **Ultralytics YOLOv8n**: ê²½ëŸ‰ ê°ì²´ ê°ì§€ ëª¨ë¸
- **OpenCV**: ì´ë¯¸ì§€ ì²˜ë¦¬
- **NumPy**: ë°°ì—´ ì—°ì‚°

## ì„¤ì¹˜ ë° ì‹¤í–‰

### í•„ìˆ˜ ìš”êµ¬ì‚¬í•­

- Python 3.12+
- ZED SDK 4.x
- CUDA-capable GPU (ê¶Œì¥)
- Node.js 18+ (í”„ë¡ íŠ¸ì—”ë“œ)

### 1. ì €ì¥ì†Œ í´ë¡ 

```bash
git clone https://github.com/beststory/zed-ai-detection.git
cd zed-ai-detection
```

### 2. Python í™˜ê²½ ì„¤ì •

```bash
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install -r requirements.txt
```

### 3. ZED SDK ì„¤ì¹˜

[ZED SDK ë‹¤ìš´ë¡œë“œ](https://www.stereolabs.com/developers/release/)ì—ì„œ í”Œë«í¼ì— ë§ëŠ” SDKë¥¼ ì„¤ì¹˜í•˜ì„¸ìš”.

### 4. ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”

```bash
python initialize_system.py
```

### 5. ì‹œìŠ¤í…œ ì‹¤í–‰

#### ë°±ì—”ë“œ ì„œë²„ ì‹œì‘
```bash
# í„°ë¯¸ë„ 1: ZED ì¹´ë©”ë¼ ìº¡ì²˜
sudo -E ./venv/bin/python zed_capture.py

# í„°ë¯¸ë„ 2: FastAPI ë°±ì—”ë“œ
python main.py
```

#### í”„ë¡ íŠ¸ì—”ë“œ ì„œë²„ ì‹œì‘
```bash
cd frontend
npm install
npm run dev
```

### 6. ì ‘ì†

- **í”„ë¡ íŠ¸ì—”ë“œ**: http://localhost:5173
- **ë°±ì—”ë“œ API**: http://localhost:8005
- **API ë¬¸ì„œ**: http://localhost:8005/docs

## API ì—”ë“œí¬ì¸íŠ¸

### REST API

- `GET /api/events/latest` - ìµœê·¼ ì´ë²¤íŠ¸ ì¡°íšŒ
- `GET /api/events/history` - ì´ë²¤íŠ¸ íˆìŠ¤í† ë¦¬
- `GET /api/events/{event_id}` - íŠ¹ì • ì´ë²¤íŠ¸ ìƒì„¸
- `GET /api/movement/tracking/{object_id}` - ê°ì²´ ì¶”ì  ì •ë³´
- `GET /api/cameras/status` - ì¹´ë©”ë¼ ìƒíƒœ

### WebSocket

- `WS /api/ws/events` - ì‹¤ì‹œê°„ ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¼
- `WS /api/ws/tracking` - ì‹¤ì‹œê°„ ìœ„ì¹˜ ì¶”ì 

## ì´ë²¤íŠ¸ íƒ€ì…

- `new_object`: ìƒˆë¡œìš´ ê°ì²´ ê°ì§€
- `zone_entry`: êµ¬ì—­ ì§„ì…
- `zone_exit`: êµ¬ì—­ ì´íƒˆ
- `speed_alert`: ì†ë„ ê²½ê³  (>2.0 m/s)
- `distance_change`: ê±°ë¦¬ ë³€í™” (>0.5m)
- `idle`: ì •ì§€ ìƒíƒœ (<0.1 m/s)

## ì„¤ì •

`config.py`ì—ì„œ ë‹¤ìŒ ì„¤ì •ì„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```python
# ê°ì§€ ì„¤ì •
PERSON_CONFIDENCE_THRESHOLD = 0.5
TRACKING_MAX_DISAPPEARED = 30

# ì´ë²¤íŠ¸ ì„¤ì •
SPEED_THRESHOLD = 2.0  # m/s
DISTANCE_THRESHOLD = 0.5  # meters
IDLE_THRESHOLD = 0.1  # m/s

# ë„¤íŠ¸ì›Œí¬ ì„¤ì •
ZMQ_PORT = 5555
API_PORT = 8005
```

## í”„ë¡œì íŠ¸ êµ¬ì¡°

```
zed-ai-detection/
â”œâ”€â”€ main.py                 # FastAPI ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜
â”œâ”€â”€ zed_capture.py          # ZED ì¹´ë©”ë¼ ZMQ í¼ë¸”ë¦¬ì…”
â”œâ”€â”€ zmq_frame_receiver.py   # ZMQ í”„ë ˆì„ ìˆ˜ì‹ ê¸°
â”œâ”€â”€ config.py               # ì„¤ì • íŒŒì¼
â”œâ”€â”€ requirements.txt        # Python ì˜ì¡´ì„±
â”‚
â”œâ”€â”€ ai/                     # AI ë¶„ì„ ëª¨ë“ˆ
â”‚   â”œâ”€â”€ analyzer.py
â”‚   â””â”€â”€ ollama_client.py
â”‚
â”œâ”€â”€ api/                    # API ë¼ìš°íŠ¸
â”‚   â”œâ”€â”€ multimodal_routes.py
â”‚   â””â”€â”€ websocket/
â”‚       â””â”€â”€ events.py
â”‚
â”œâ”€â”€ db/                     # ë°ì´í„°ë² ì´ìŠ¤
â”‚   â”œâ”€â”€ database.py
â”‚   â””â”€â”€ schema.sql
â”‚
â”œâ”€â”€ detection/              # ê°ì§€ ëª¨ë“ˆ
â”‚   â”œâ”€â”€ person.py          # ì‚¬ëŒ ê°ì§€ (YOLOv8)
â”‚   â”œâ”€â”€ motion.py          # ì›€ì§ì„ ê°ì§€
â”‚   â””â”€â”€ structure.py       # êµ¬ì¡° ë³€í™” ê°ì§€
â”‚
â”œâ”€â”€ events/                 # ì´ë²¤íŠ¸ ì²˜ë¦¬
â”‚   â””â”€â”€ detector.py
â”‚
â”œâ”€â”€ tracking/               # ì¶”ì  ì‹œìŠ¤í…œ
â”‚   â””â”€â”€ movement.py
â”‚
â”œâ”€â”€ sync/                   # í”„ë ˆì„ ë™ê¸°í™”
â”‚   â””â”€â”€ frame_sync.py
â”‚
â””â”€â”€ frontend/               # ì›¹ ì¸í„°í˜ì´ìŠ¤
    â”œâ”€â”€ index.html
    â”œâ”€â”€ app.js
    â””â”€â”€ package.json
```

## ì„±ëŠ¥ ìµœì í™”

- **ë¹„ë™ê¸° ì²˜ë¦¬**: asyncioë¥¼ í™œìš©í•œ ë™ì‹œ ì‘ì—… ì²˜ë¦¬
- **í”„ë ˆì„ ìŠ¤í‚µ**: 10 FPSë¡œ ì²˜ë¦¬ ì†ë„ ì¡°ì ˆ
- **ë°°ì¹˜ ì²˜ë¦¬**: ì—¬ëŸ¬ ì´ë²¤íŠ¸ë¥¼ íì— ëª¨ì•„ì„œ ì²˜ë¦¬
- **ìºì‹±**: í”„ë ˆì„ ë° ê°ì§€ ê²°ê³¼ ìºì‹±

## ë¬¸ì œ í•´ê²°

### ZED ì¹´ë©”ë¼ê°€ ì¸ì‹ë˜ì§€ ì•Šì„ ë•Œ

```bash
# ì¹´ë©”ë¼ ê¶Œí•œ í™•ì¸
sudo usermod -aG video $USER

# ZED ì§„ë‹¨
python test_zed_detailed.py
```

### WebSocket ì—°ê²° ì‹¤íŒ¨

- ë¸Œë¼ìš°ì € ê°•ë ¥ ìƒˆë¡œê³ ì¹¨ (Ctrl+Shift+R)
- CORS ì„¤ì • í™•ì¸
- ë°©í™”ë²½ ì„¤ì • í™•ì¸

### ê°ì§€ê°€ ì‘ë™í•˜ì§€ ì•Šì„ ë•Œ

```bash
# ê°ì§€ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
python test_detection.py

# ë¡œê·¸ í™•ì¸
tail -f /tmp/mm_backend_final.log
```

## ë¼ì´ì„ ìŠ¤

MIT License

## ê¸°ì—¬

Pull Requestë¥¼ í™˜ì˜í•©ë‹ˆë‹¤!

## ì§€ì›

ë¬¸ì œê°€ ë°œìƒí•˜ë©´ [Issues](https://github.com/beststory/zed-ai-detection/issues)ì— ë“±ë¡í•´ì£¼ì„¸ìš”.

---

ğŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
